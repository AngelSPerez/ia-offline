<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="./wllama.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#1c1c1c" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>IA</title>
    
    <link rel="manifest" href="./manifest.json">
    
    <script type="module" crossorigin src="./assets/index-BZ_wFqig.js"></script>
    <link rel="stylesheet" crossorigin href="./assets/index-q-smNyI7.css">
    
    <link rel="stylesheet" href="./custom-whyai.css">

    <style>
      /* --- 1. OVERLAYS VISUALES (T√É∆íTULO Y FOOTER) --- */
      
      #fake-title-overlay {
        position: fixed; 
        top: 0; 
        left: 0; 
        z-index: 9998;
        
        /* Ajustes Desktop */
        height: 62px;
        margin-left: 15px;
        padding: 0 16px; 
        display: flex; 
        align-items: center;
        /* Alineaci√É∆í√Ç¬≥n a la izquierda */
        justify-content: flex-start; 
        gap: 15px; /* Espacio entre el bot√É∆í√Ç¬≥n y el t√É∆í√Ç¬≠tulo */
        
        background-color: #1c1c1c; 
        min-width: 200px; 
        pointer-events: none; 
        
        transition: opacity 0.3s ease, visibility 0.3s;
      }

      /* El contenido interactivo debe capturar clicks */
      #fake-title-overlay > * {
        pointer-events: auto;
      }

      #fake-title-overlay h1 {
        color: #ececec; 
        font-family: ui-sans-serif, system-ui, sans-serif;
        font-weight: bold; 
        font-size: 1.25rem; 
        margin: 0;
        pointer-events: none;
      }
      
      /* Bot√É∆í√Ç¬≥n Hamburguesa (Ahora a la izquierda) */
      .hamburger-btn {
        background: transparent;
        border: none;
        color: #ececec;
        cursor: pointer;
        padding: 8px;
        /* Quitamos m√É∆í√Ç¬°rgenes manuales, usamos gap en el padre */
        margin: 0; 
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 4px;
      }
      .hamburger-btn svg {
        width: 24px;
        height: 24px;
        fill: currentColor;
      }
      .hamburger-btn:hover {
        background-color: rgba(255,255,255,0.1);
      }

      #fake-footer-overlay {
        position: fixed; 
        bottom: 0; 
        left: 0; 
        width: 80%; 
        height: 40px;
        background-color: #1c1c1c; 
        z-index: 3; 
        display: flex;
        justify-content: center; 
        align-items: center; 
        pointer-events: none;
        margin-left: 18%;
        transition: background-color 0.3s;
      }

      #fake-footer-overlay p {
        color: #888; 
        font-family: ui-sans-serif, system-ui, sans-serif;
        font-size: 0.75rem; 
        margin: 0; 
        opacity: 0.8;
      }

      /* --- AJUSTES M√É∆í"VILES --- */
      @media (max-width: 1028px) {
        #fake-title-overlay {
           background-color: #1d232a !important; 
           margin-left: 0 !important; 
           width: 100% !important; 
           box-sizing: border-box; 
        }
        
        #fake-footer-overlay {
           background-color: #1d232a !important; 
           width: 100% !important;
           margin-left: 0 !important;
        }
      }

      /* --- 2. MODAL DE BIENVENIDA / AVISO --- */
      .modal-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0, 0, 0, 0.85);
        z-index: 100000;
        display: flex; justify-content: center; align-items: center;
        backdrop-filter: blur(5px);
        opacity: 0; visibility: hidden; transition: opacity 0.3s ease;
      }
      
      .modal-overlay.active {
        opacity: 1; visibility: visible;
      }

      .modal-box {
        background: #2a2a2a; border: 1px solid #444;
        padding: 25px; border-radius: 12px; max-width: 90%; width: 450px;
        text-align: center; color: #ececec;
        font-family: ui-sans-serif, system-ui, sans-serif;
        box-shadow: 0 10px 25px rgba(0,0,0,0.5);
        max-height: 90vh;
        overflow-y: auto;
      }

      .modal-box h2 { margin-top: 0; color: #fff; }
      .modal-box p { color: #ccc; line-height: 1.5; font-size: 0.95rem; }
      
      .model-recommendation {
        background: #1c1c1c; padding: 15px; border-radius: 8px;
        margin: 15px 0; border: 1px solid #444;
        text-align: left;
      }

      .model-option {
        margin-bottom: 12px;
        padding: 12px;
        background: #1a1a1a;
        border-radius: 6px;
        border-left: 3px solid #666;
      }

      .model-option:last-child {
        margin-bottom: 0;
      }

      .model-name {
        color: #4ade80;
        font-weight: bold;
        font-family: monospace;
        display: block;
        font-size: 1rem;
        margin-bottom: 5px;
      }

      .model-specs {
        font-size: 0.85rem;
        color: #aaa;
        line-height: 1.4;
        text-align: left;
      }

      .speed-indicator {
        display: inline-block;
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 0.75rem;
        font-weight: bold;
        margin-top: 5px;
      }

      .speed-slow { background: #3b3b2f; color: #e3d550; }
      .speed-fast { background: #2f3b2f; color: #50e380; }
      .speed-mobile { background: #2f2f3b; color: #80a0e3; }

      .specs-table {
        background: #1c1c1c;
        border: 1px solid #444;
        border-radius: 8px;
        margin: 15px 0;
        padding: 12px;
        font-size: 0.85rem;
      }

      .specs-table p {
        margin: 8px 0;
        color: #bbb;
      }

      .specs-table strong {
        color: #4ade80;
      }

      .close-btn {
        background: #ececec; color: #1c1c1c; border: none;
        padding: 10px 20px; border-radius: 6px; font-weight: bold;
        cursor: pointer; margin-top: 15px; width: 100%;
        transition: background 0.2s;
      }
      .close-btn:hover { background: #fff; }

    </style>
  </head>
  <body>
    
    <div id="welcome-modal" class="modal-overlay">
      <div class="modal-box">
        <h2 id="modal-title">‚ö†Ô∏è Beta Version</h2>
        <p id="modal-subtitle">This is an experimental feature, so it may be slow the first time.</p>
        
        <div class="specs-table">
          <p id="specs-label"><strong id="specs-title">Recommended Settings:</strong></p>
          <p id="context-text">Context Size: <strong>1024</strong></p>
          <p id="tokens-text">Max Tokens: <strong>512</strong></p>
          <p id="temp-text">Temperature: <strong>0.15</strong></p>
        </div>
        
        <div class="model-recommendation">
          <p id="choose-model" style="margin: 0 0 12px 0; font-size: 0.85rem; color: #999;">Choose a model:</p>
          
          <div class="model-option">
            <span class="model-name">Gemma 2 2B</span>
            <div class="model-specs">
              <span id="gemma-desc">üß† Slower but smarter. Best for complex responses.</span>
              <span class="speed-indicator speed-slow" id="gemma-speed">Speed: Slow</span>
            </div>
          </div>

          <div class="model-option">
            <span class="model-name">Llama 3.2 1B</span>
            <div class="model-specs">
              <span id="llama-desc">‚ö° Faster but more basic. Ideal for quick responses.</span>
              <span class="speed-indicator speed-fast" id="llama-speed">Speed: Fast</span>
            </div>
          </div>

          <div id="mobile-option" class="model-option" style="display: none;">
            <span class="model-name">LFM2-1.2B</span>
            <div class="model-specs">
              <span id="lfm-desc">üì± Ideal for mobile. Fast and lightweight.</span><br>
              <span id="lfm-desc2">The answers may be less concise due to the size of the model.</span>
              <span class="speed-indicator speed-mobile" id="lfm-speed">Speed: Mobile Optimized</span>
            </div>
          </div>
        </div>

        <p id="modal-footer" style="font-size: 0.8rem; opacity: 0.8;">
          You must download the model using the internet. After that, you can use WhyAI completely offline.
        </p>

        <button class="close-btn" onclick="cerrarModal()" id="close-btn">Got it</button>
      </div>
    </div>

    <div id="fake-footer-overlay"><p>WhyAI can make mistakes. Check important information.</p></div>
    
    <div id="root"></div>
    
    <div class="credits">
      ü§ñ Powered by <a href="https://bit.ly/poweredby23" target="_blank"><img src="power.png" alt="powered" width="130px" height="20px"></a>
      <span style="font-size: 0.65rem; opacity: 0.7;">Created by <strong>WhyAI</strong></span>
    </div>

    <script>
      // --- 1. L√ìGICA DEL T√çTULO FALSO ---
      function ocultarHeader() {
        // Solo permitir ocultar en m√≥vil
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        
        if (isMobile) {
          const header = document.getElementById('fake-title-overlay');
          // Ocultamos visualmente
          header.style.opacity = '0';
          header.style.visibility = 'hidden';
        }
      }

      // --- 2. L√ìGICA DE IDIOMA BASADA EN GEOLOCALIZACI√ìN ---
      const translations = {
        es: {
          title: "‚ö†Ô∏è Versi√≥n Beta",
          subtitle: "Esta es una funci√≥n experimental, por lo que puede ser lenta la primera vez.",
          specsTitle: "Configuraci√≥n Recomendada:",
          contextText: "Tama√±o de Contexto: ",
          tokensText: "Tokens M√°ximos: ",
          tempText: "Temperatura: ",
          chooseModel: "Elige un modelo:",
          gemmaDesc: "üß† M√°s lento pero m√°s inteligente. Mejor para respuestas complejas.",
          gemmaSpeed: "Velocidad: Lenta",
          llamaDesc: "‚ö° M√°s r√°pido pero m√°s b√°sico. Ideal para respuestas r√°pidas.",
          llamaSpeed: "Velocidad: R√°pida",
          lfmDesc: "üì± Ideal para m√≥vil. R√°pido y ligero.",
          lfmDesc2: "Las respuestas pueden ser menos concisas debido al tama√±o del modelo.",
          lfmSpeed: "Velocidad: Optimizado M√≥vil",
          footer: "Debes descargar el modelo usando internet. Despu√©s podr√°s usar WhyAI totalmente desconectado.",
          closeBtn: "Entendido"
        },
        en: {
          title: "‚ö†Ô∏è Beta Version",
          subtitle: "This is an experimental feature, so it may be slow the first time.",
          specsTitle: "Recommended Settings:",
          contextText: "Context Size: ",
          tokensText: "Max Tokens: ",
          tempText: "Temperature: ",
          chooseModel: "Choose a model:",
          gemmaDesc: "üß† Slower but smarter. Best for complex responses.",
          gemmaSpeed: "Speed: Slow",
          llamaDesc: "‚ö° Faster but more basic. Ideal for quick responses.",
          llamaSpeed: "Speed: Fast",
          lfmDesc: "üì± Ideal for mobile. Fast and lightweight.",
          lfmDesc2: "The answers may be less concise due to the size of the model.",
          lfmSpeed: "Speed: Mobile Optimized",
          footer: "You must download the model using the internet. After that, you can use WhyAI completely offline.",
          closeBtn: "Got it"
        }
      };

      async function detectarIdioma() {
        try {
          const response = await fetch('https://ipapi.co/json/');
          const data = await response.json();
          const country = data.country_code;
          
          // Pa√≠ses hispanohablantes
          const hispanicCountries = [
            'ES', 'MX', 'AR', 'CO', 'PE', 'VE', 'CL', 'EC', 'BO', 'PY',
            'UY', 'CU', 'DO', 'GT', 'HN', 'SV', 'NI', 'CR', 'PA', 'PR',
            'GQ', 'BZ', 'PH' // Nota: PH (Filipinas) tiene relaci√≥n hist√≥rica
          ];
          
          const language = hispanicCountries.includes(country) ? 'es' : 'en';
          aplicarIdioma(language);
        } catch (error) {
          console.log('No se pudo detectar el idioma, usando ingl√©s por defecto');
          aplicarIdioma('en');
        }
      }

      function aplicarIdioma(lang) {
        const t = translations[lang] || translations.en;
        
        document.getElementById('modal-title').textContent = t.title;
        document.getElementById('modal-subtitle').textContent = t.subtitle;
        document.getElementById('specs-title').textContent = t.specsTitle;
        document.getElementById('context-text').innerHTML = t.contextText + '<strong>1024</strong>';
        document.getElementById('tokens-text').innerHTML = t.tokensText + '<strong>512</strong>';
        document.getElementById('temp-text').innerHTML = t.tempText + '<strong>0.15</strong>';
        document.getElementById('choose-model').textContent = t.chooseModel;
        document.getElementById('gemma-desc').textContent = t.gemmaDesc;
        document.getElementById('gemma-speed').textContent = t.gemmaSpeed;
        document.getElementById('llama-desc').textContent = t.llamaDesc;
        document.getElementById('llama-speed').textContent = t.llamaSpeed;
        document.getElementById('lfm-desc').textContent = t.lfmDesc;
        document.getElementById('lfm-speed').textContent = t.lfmSpeed;
        document.getElementById('modal-footer').textContent = t.footer;
        document.getElementById('close-btn').textContent = t.closeBtn;
      }

      // --- 3. L√ìGICA DEL MODAL Y MODELOS ---
      function detectarDispositivo() {
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        const mobileOption = document.getElementById('mobile-option');
        
        if (isMobile && mobileOption) {
          mobileOption.style.display = 'block';
        }
      }

      function mostrarModal() {
        const modal = document.getElementById('welcome-modal');
        setTimeout(() => {
            modal.classList.add('active');
        }, 500);
      }

      function cerrarModal() {
        document.getElementById('welcome-modal').classList.remove('active');
      }

      detectarIdioma();
      detectarDispositivo();
      mostrarModal();

      // --- 3. SCRIPT PARA REEMPLAZAR "wllama" POR "WhyAI" ---
      function reemplazarWllama() {
          // Obtener todos los nodos de texto del documento
          const walker = document.createTreeWalker(
              document.body,
              NodeFilter.SHOW_TEXT,
              null,
              false
          );

          let node;
          const nodesToModify = [];

          // Recopilar todos los nodos que contienen "wllama"
          while (node = walker.nextNode()) {
              if (node.nodeValue && node.nodeValue.toLowerCase().includes('wllama')) {
                  // Excluir el div de cr√©ditos
                  if (!node.parentElement.closest('.credits')) {
                      nodesToModify.push(node);
                  }
              }
          }

          // Reemplazar el texto en cada nodo
          nodesToModify.forEach(node => {
              // Reemplazar "wllama" (case-insensitive)
              node.nodeValue = node.nodeValue.replace(/wllama/gi, 'WhyAI');
          });

          // Tambi√©n reemplazar en atributos de etiquetas (href, title, alt, etc.)
          const allElements = document.querySelectorAll('*:not(.credits) *');
          allElements.forEach(el => {
              // Reemplazar en todos los atributos
              Array.from(el.attributes).forEach(attr => {
                  if (attr.value && attr.value.toLowerCase().includes('wllama')) {
                      attr.value = attr.value.replace(/wllama/gi, 'WhyAI');
                  }
              });
          });
      }

      // Ejecutar cuando el DOM est√© listo
      if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', reemplazarWllama);
      } else {
          reemplazarWllama();
      }

      // Ejecutar tambi√©n despu√©s de que se carguen din√°micamente nuevos elementos
      const observer = new MutationObserver(reemplazarWllama);
      observer.observe(document.body, {
          childList: true,
          subtree: true,
          characterData: true
      });

      // --- 4. SCRIPT DE LIMPIEZA DE INTERFAZ ---
      function limpiarInterfaz() {
          const menuItems = document.querySelectorAll('a, button, li');
          const palabrasProhibidas = ['report bugs', 'debug log', 'open a issue', 'github', 'discord', 'guide'];
          
          menuItems.forEach(el => {
              if (el.offsetParent !== null && el.innerText) {
                  const texto = el.innerText.toLowerCase();
                  if (palabrasProhibidas.some(palabra => texto.includes(palabra))) {
                      el.style.display = 'none';
                  }
              }
          });
          if (document.title.includes('Wllama')) { document.title = "WhyAI"; }
      }
      setInterval(limpiarInterfaz, 100);

      
      // --- 5. REGISTRO DEL SERVICE WORKER (OFFLINE) ---
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('./sw.js')
            .then(registration => {
              console.log('WhyAI SW Registrado');
            })
            .catch(error => {
              console.log('Error SW:', error);
            });
        });
      }
    </script>
  </body>
</html>

